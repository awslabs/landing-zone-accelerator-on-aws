// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`SecurityAuditStack Construct(SecurityAuditStack):  Snapshot Test 1`] = `
{
  "Parameters": {
    "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter": {
      "Default": "/accelerator/kms/cloudwatch/key-arn",
      "Type": "AWS::SSM::Parameter::Value<String>",
    },
    "SsmParameterValueacceleratorkmss3keyarnC96584B6F00A464EAD1953AFF4B05118Parameter": {
      "Default": "/accelerator/kms/s3/key-arn",
      "Type": "AWS::SSM::Parameter::Value<String>",
    },
  },
  "Resources": {
    "AcceleratorSnsKeyAlias1909B90C": {
      "Properties": {
        "AliasName": "alias/accelerator/kms/sns/key",
        "TargetKeyId": {
          "Fn::GetAtt": [
            "AcceleratorSnsKeyDADF94B1",
            "Arn",
          ],
        },
      },
      "Type": "AWS::KMS::Alias",
    },
    "AcceleratorSnsKeyDADF94B1": {
      "DeletionPolicy": "Retain",
      "Properties": {
        "Description": "AWS Accelerator SNS Kms Key",
        "EnableKeyRotation": true,
        "KeyPolicy": {
          "Statement": [
            {
              "Action": "kms:*",
              "Effect": "Allow",
              "Principal": {
                "AWS": {
                  "Fn::Join": [
                    "",
                    [
                      "arn:",
                      {
                        "Ref": "AWS::Partition",
                      },
                      ":iam::222222222222:root",
                    ],
                  ],
                },
              },
              "Resource": "*",
            },
            {
              "Action": [
                "kms:Encrypt",
                "kms:Decrypt",
                "kms:ReEncrypt*",
                "kms:GenerateDataKey*",
                "kms:DescribeKey",
              ],
              "Condition": {
                "ArnLike": {
                  "aws:PrincipalARN": [
                    {
                      "Fn::Join": [
                        "",
                        [
                          "arn:",
                          {
                            "Ref": "AWS::Partition",
                          },
                          ":iam::*:role/AWSAccelerator-*",
                        ],
                      ],
                    },
                  ],
                },
                "StringEquals": {
                  "aws:PrincipalOrgID": "o-asdf123456",
                },
              },
              "Effect": "Allow",
              "Principal": {
                "AWS": "*",
              },
              "Resource": "*",
              "Sid": "Allow Accelerator Role to use the encryption key",
            },
          ],
          "Version": "2012-10-17",
        },
      },
      "Type": "AWS::KMS::Key",
      "UpdateReplacePolicy": "Retain",
    },
    "AccessAnalyzer": {
      "Properties": {
        "Type": "ORGANIZATION",
      },
      "Type": "AWS::AccessAnalyzer::Analyzer",
    },
    "AttachIamInstanceProfileC858EC06": {
      "Properties": {
        "Content": {
          "assumeRole": "{{ AutomationAssumeRole }}",
          "description": "Associate AWS Iam Instance Profile to EC2 Instance",
          "mainSteps": [
            {
              "action": "aws:executeAwsApi",
              "inputs": {
                "Api": "associate_iam_instance_profile",
                "IamInstanceProfile": {
                  "Name": "{{ IamInstanceProfile }}",
                },
                "InstanceId": "{{ InstanceId }}",
                "Service": "ec2",
              },
              "name": "associateIamProfile",
            },
          ],
          "parameters": {
            "AutomationAssumeRole": {
              "type": "String",
            },
            "IamInstanceProfile": {
              "type": "String",
            },
            "InstanceId": {
              "type": "String",
            },
          },
          "schemaVersion": "0.3",
        },
        "DocumentType": "Automation",
        "Name": "Attach-IAM-Instance-Profile",
        "UpdateMethod": "NewVersion",
      },
      "Type": "AWS::SSM::Document",
    },
    "AttachIamInstanceProfileShareDocumentD1F87A43": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomSSMShareDocumentCustomResourceProviderLogGroup11AEA42B",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomSSMShareDocumentCustomResourceProviderHandler02D98C87",
            "Arn",
          ],
        },
        "accountIds": [
          "111111111111",
          "333333333333",
          "222222222222",
          "444444444444",
          "555555555555",
          "666666666666",
        ],
        "name": {
          "Ref": "AttachIamInstanceProfileC858EC06",
        },
      },
      "Type": "Custom::SSMShareDocument",
      "UpdateReplacePolicy": "Delete",
    },
    "AttachIamRolePolicy19A43F7E": {
      "Properties": {
        "Content": {
          "assumeRole": "{{ AutomationAssumeRole }}",
          "description": "IAM Role Policy",
          "mainSteps": [
            {
              "action": "aws:executeScript",
              "inputs": {
                "Handler": "script_handler",
                "InputPayload": {
                  "AWSManagedPolicies": "{{ AWSManagedPolicies }}",
                  "CustomerManagedPolicies": "{{ CustomerManagedPolicies }}",
                  "ResourceId": "{{ ResourceId }}",
                },
                "Runtime": "python3.7",
                "Script": "import boto3
partition = boto3.client("sts").get_caller_identity()['Arn'].split(":")[1]
iam = boto3.client("iam")
config = boto3.client("config")
def script_handler(events, context):
  resource_id = events["ResourceId"]
  response = config.batch_get_resource_config(
    resourceKeys=[{
      'resourceType': 'AWS::IAM::Role',
      'resourceId': resource_id
    }]
  )
  role_name = response["baseConfigurationItems"][0]['resourceName']
  aws_policy_names = events["AWSManagedPolicies"]
  customer_policy_names = events["CustomerManagedPolicies"]
  for policy in aws_policy_names:
    iam.attach_role_policy(
      PolicyArn="arn:%s:iam::aws:policy/%s" %(partition, policy),
      RoleName=role_name
    )
  for policy in customer_policy_names:
    iam.attach_role_policy(
      PolicyArn=policy,
      RoleName=role_name
    )",
              },
              "name": "attachPolicy",
            },
          ],
          "parameters": {
            "AWSManagedPolicies": {
              "type": "StringList",
            },
            "AutomationAssumeRole": {
              "type": "String",
            },
            "CustomerManagedPolicies": {
              "default": [],
              "minItems": 0,
              "type": "StringList",
            },
            "ResourceId": {
              "type": "String",
            },
          },
          "schemaVersion": "0.3",
        },
        "DocumentType": "Automation",
        "Name": "Attach-IAM-Role-Policy",
        "UpdateMethod": "NewVersion",
      },
      "Type": "AWS::SSM::Document",
    },
    "AttachIamRolePolicyShareDocumentF5C9E6C7": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomSSMShareDocumentCustomResourceProviderLogGroup11AEA42B",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomSSMShareDocumentCustomResourceProviderHandler02D98C87",
            "Arn",
          ],
        },
        "accountIds": [
          "111111111111",
          "333333333333",
          "222222222222",
          "444444444444",
          "555555555555",
          "666666666666",
        ],
        "name": {
          "Ref": "AttachIamRolePolicy19A43F7E",
        },
      },
      "Type": "Custom::SSMShareDocument",
      "UpdateReplacePolicy": "Delete",
    },
    "AuditManagerDefaultReportsDestinationAFD20D60": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomAuditManagerCreateDefaultReportsDestinationCustomResourceProviderLogGroupF5AC3566",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomAuditManagerCreateDefaultReportsDestinationCustomResourceProviderHandler6BCBC433",
            "Arn",
          ],
        },
        "bucket": {
          "Fn::Join": [
            "",
            [
              "s3://'",
              {
                "Ref": "AuditManagerPublishingDestinationBucket74974FCF",
              },
              "/audit-manager/222222222222/",
            ],
          ],
        },
        "defaultReportsDestinationType": "S3",
        "kmsKeyArn": {
          "Ref": "SsmParameterValueacceleratorkmss3keyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "region": "us-east-1",
      },
      "Type": "Custom::AuditManagerCreateDefaultReportsDestination",
      "UpdateReplacePolicy": "Delete",
    },
    "AuditManagerPublishingDestinationBucket74974FCF": {
      "DeletionPolicy": "Retain",
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-S1",
              "reason": "AuditManagerPublishingDestinationBucket has server access logs disabled till the task for access logging completed.",
            },
          ],
        },
      },
      "Properties": {
        "BucketEncryption": {
          "ServerSideEncryptionConfiguration": [
            {
              "ServerSideEncryptionByDefault": {
                "KMSMasterKeyID": {
                  "Ref": "SsmParameterValueacceleratorkmss3keyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
                },
                "SSEAlgorithm": "aws:kms",
              },
            },
          ],
        },
        "BucketName": {
          "Fn::Join": [
            "",
            [
              "aws-accelerator-auditmgr-",
              {
                "Ref": "AWS::AccountId",
              },
              "-",
              {
                "Ref": "AWS::Region",
              },
            ],
          ],
        },
        "LoggingConfiguration": {
          "DestinationBucketName": {
            "Fn::Join": [
              "",
              [
                "aws-accelerator-s3-access-logs-",
                {
                  "Ref": "AWS::AccountId",
                },
                "-",
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
        },
        "OwnershipControls": {
          "Rules": [
            {
              "ObjectOwnership": "BucketOwnerPreferred",
            },
          ],
        },
        "PublicAccessBlockConfiguration": {
          "BlockPublicAcls": true,
          "BlockPublicPolicy": true,
          "IgnorePublicAcls": true,
          "RestrictPublicBuckets": true,
        },
        "Tags": [
          {
            "Key": "aws-cdk:auto-audit-manager-access-bucket",
            "Value": "true",
          },
          {
            "Key": "aws-cdk:auto-auditManager-access-bucket",
            "Value": "true",
          },
        ],
        "VersioningConfiguration": {
          "Status": "Enabled",
        },
      },
      "Type": "AWS::S3::Bucket",
      "UpdateReplacePolicy": "Retain",
    },
    "AuditManagerPublishingDestinationBucketAuditManagerPublishingDestinationBucketReplicationAwsAcceleratorCentralLogs333333333333UsWest2ReplicationRoleDefaultPolicy6D87750E": {
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "Allows only specific policy.",
            },
          ],
        },
      },
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "s3:GetObjectLegalHold",
                "s3:GetObjectRetention",
                "s3:GetObjectVersion",
                "s3:GetObjectVersionAcl",
                "s3:GetObjectVersionForReplication",
                "s3:GetObjectVersionTagging",
                "s3:GetReplicationConfiguration",
                "s3:ListBucket",
                "s3:ReplicateDelete",
                "s3:ReplicateObject",
                "s3:ReplicateTags",
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "AuditManagerPublishingDestinationBucket74974FCF",
                    "Arn",
                  ],
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "AuditManagerPublishingDestinationBucket74974FCF",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
            {
              "Action": [
                "s3:GetBucketVersioning",
                "s3:GetObjectVersionTagging",
                "s3:ObjectOwnerOverrideToBucketOwner",
                "s3:PutBucketVersioning",
                "s3:ReplicateDelete",
                "s3:ReplicateObject",
                "s3:ReplicateTags",
              ],
              "Effect": "Allow",
              "Resource": {
                "Fn::Join": [
                  "",
                  [
                    "arn:",
                    {
                      "Ref": "AWS::Partition",
                    },
                    ":s3:::aws-accelerator-central-logs-333333333333-us-west-2/*",
                  ],
                ],
              },
            },
            {
              "Action": "kms:Decrypt",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueacceleratorkmss3keyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
              },
            },
            {
              "Action": "kms:Encrypt",
              "Effect": "Allow",
              "Resource": {
                "Ref": "CentralLogsBucketKeyLookup52CD8A37",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ditManagerPublishingDestinationBucketReplicationAwsAcceleratorCentralLogs333333333333UsWest2ReplicationRoleDefaultPolicy6D87750E",
        "Roles": [
          {
            "Ref": "AuditManagerPublishingDestinationBucketAuditManagerPublishingDestinationBucketReplicationAwsAcceleratorCentralLogs333333333333UsWest2ReplicationRoleE0509DD9",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "AuditManagerPublishingDestinationBucketAuditManagerPublishingDestinationBucketReplicationAwsAcceleratorCentralLogs333333333333UsWest2ReplicationRoleE0509DD9": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "s3.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "Path": "/service-role/",
        "Tags": [
          {
            "Key": "aws-cdk:auto-audit-manager-access-bucket",
            "Value": "true",
          },
          {
            "Key": "aws-cdk:auto-auditManager-access-bucket",
            "Value": "true",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "AuditManagerPublishingDestinationBucketAuditManagerPublishingDestinationBucketReplicationECF1B287": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomS3PutBucketReplicationCustomResourceProviderLogGroup6A67905E",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomS3PutBucketReplicationCustomResourceProviderHandler1D75398C",
            "Arn",
          ],
        },
        "destinationAccountId": "333333333333",
        "destinationBucketArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition",
              },
              ":s3:::aws-accelerator-central-logs-333333333333-us-west-2",
            ],
          ],
        },
        "destinationBucketKeyArn": {
          "Ref": "CentralLogsBucketKeyLookup52CD8A37",
        },
        "prefix": "",
        "replicationRoleArn": {
          "Fn::GetAtt": [
            "AuditManagerPublishingDestinationBucketAuditManagerPublishingDestinationBucketReplicationAwsAcceleratorCentralLogs333333333333UsWest2ReplicationRoleE0509DD9",
            "Arn",
          ],
        },
        "sourceBucketName": {
          "Ref": "AuditManagerPublishingDestinationBucket74974FCF",
        },
      },
      "Type": "Custom::S3PutBucketReplication",
      "UpdateReplacePolicy": "Delete",
    },
    "AuditManagerPublishingDestinationBucketPolicy3992854B": {
      "Properties": {
        "Bucket": {
          "Ref": "AuditManagerPublishingDestinationBucket74974FCF",
        },
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "s3:*",
              "Condition": {
                "Bool": {
                  "aws:SecureTransport": "false",
                },
              },
              "Effect": "Deny",
              "Principal": {
                "AWS": "*",
              },
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "AuditManagerPublishingDestinationBucket74974FCF",
                    "Arn",
                  ],
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "AuditManagerPublishingDestinationBucket74974FCF",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
              "Sid": "deny-insecure-connections",
            },
            {
              "Action": [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
                "s3:DeleteObject*",
                "s3:PutObject",
                "s3:PutObjectLegalHold",
                "s3:PutObjectRetention",
                "s3:PutObjectTagging",
                "s3:PutObjectVersionTagging",
                "s3:Abort*",
              ],
              "Effect": "Allow",
              "Principal": {
                "Service": "auditmanager.amazonaws.com",
              },
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "AuditManagerPublishingDestinationBucket74974FCF",
                    "Arn",
                  ],
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "AuditManagerPublishingDestinationBucket74974FCF",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
            {
              "Action": [
                "s3:GetBucketLocation",
                "s3:PutObject",
              ],
              "Condition": {
                "StringEquals": {
                  "aws:PrincipalOrgID": "o-asdf123456",
                },
              },
              "Effect": "Allow",
              "Principal": {
                "AWS": "*",
              },
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "AuditManagerPublishingDestinationBucket74974FCF",
                    "Arn",
                  ],
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "AuditManagerPublishingDestinationBucket74974FCF",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
              "Sid": "Allow Organization principals to use of the bucket",
            },
          ],
          "Version": "2012-10-17",
        },
      },
      "Type": "AWS::S3::BucketPolicy",
    },
    "CentralLogsBucketKeyLookup52CD8A37": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomSsmGetParameterValueCustomResourceProviderLogGroup780D220D",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomSsmGetParameterValueCustomResourceProviderHandlerAAD0E7EE",
            "Arn",
          ],
        },
        "assumeRoleArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition",
              },
              ":iam::333333333333:role/AWSAccelerator-CentralBucket-KeyArnParam-Role",
            ],
          ],
        },
        "invokingAccountID": "222222222222",
        "invokingRegion": "us-east-1",
        "parameterAccountID": "333333333333",
        "parameterName": "/accelerator/logging/central-bucket/kms/arn",
        "parameterRegion": "us-west-2",
        "uuid": "REPLACED-UUID",
      },
      "Type": "Custom::SsmGetParameterValue",
      "UpdateReplacePolicy": "Delete",
    },
    "ControlTowerNotificationsForwarderFunctionAllowInvokeAWSAcceleratorSecurityAuditStack222222222222useast1ControlTowerSNSTopic2C923A0CF50B8C0E": {
      "Properties": {
        "Action": "lambda:InvokeFunction",
        "FunctionName": {
          "Fn::GetAtt": [
            "ControlTowerNotificationsForwarderFunctionFA79B131",
            "Arn",
          ],
        },
        "Principal": "sns.amazonaws.com",
        "SourceArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition",
              },
              ":sns:us-east-1:222222222222:aws-controltower-AggregateSecurityNotifications",
            ],
          ],
        },
      },
      "Type": "AWS::Lambda::Permission",
    },
    "ControlTowerNotificationsForwarderFunctionControlTowerSNSTopicF1309D6C": {
      "Properties": {
        "Endpoint": {
          "Fn::GetAtt": [
            "ControlTowerNotificationsForwarderFunctionFA79B131",
            "Arn",
          ],
        },
        "Protocol": "lambda",
        "Region": "us-east-1",
        "TopicArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition",
              },
              ":sns:us-east-1:222222222222:aws-controltower-AggregateSecurityNotifications",
            ],
          ],
        },
      },
      "Type": "AWS::SNS::Subscription",
    },
    "ControlTowerNotificationsForwarderFunctionFA79B131": {
      "DependsOn": [
        "ControlTowerNotificationsForwarderFunctionServiceRoleDefaultPolicyEBACE9AF",
        "ControlTowerNotificationsForwarderFunctionServiceRoleE83D121D",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Description": "Lambda function to forward ControlTower notifications to management account",
        "Environment": {
          "Variables": {
            "SNS_TOPIC_ARN": {
              "Fn::Join": [
                "",
                [
                  "arn:",
                  {
                    "Ref": "AWS::Partition",
                  },
                  ":sns:us-east-1:111111111111:aws-accelerator-ControlTowerNotification",
                ],
              ],
            },
          },
        },
        "Handler": "index.handler",
        "Role": {
          "Fn::GetAtt": [
            "ControlTowerNotificationsForwarderFunctionServiceRoleE83D121D",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 120,
      },
      "Type": "AWS::Lambda::Function",
    },
    "ControlTowerNotificationsForwarderFunctionServiceRoleDefaultPolicyEBACE9AF": {
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "Require access to all keys in management account",
            },
          ],
        },
      },
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "sns:Publish",
              "Effect": "Allow",
              "Resource": {
                "Fn::Join": [
                  "",
                  [
                    "arn:",
                    {
                      "Ref": "AWS::Partition",
                    },
                    ":sns:us-east-1:111111111111:aws-accelerator-ControlTowerNotification",
                  ],
                ],
              },
              "Sid": "sns",
            },
            {
              "Action": [
                "kms:DescribeKey",
                "kms:GenerateDataKey",
                "kms:Decrypt",
                "kms:Encrypt",
              ],
              "Effect": "Allow",
              "Resource": {
                "Fn::Join": [
                  "",
                  [
                    "arn:",
                    {
                      "Ref": "AWS::Partition",
                    },
                    ":kms:us-east-1:111111111111:key/*",
                  ],
                ],
              },
              "Sid": "kms",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ControlTowerNotificationsForwarderFunctionServiceRoleDefaultPolicyEBACE9AF",
        "Roles": [
          {
            "Ref": "ControlTowerNotificationsForwarderFunctionServiceRoleE83D121D",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ControlTowerNotificationsForwarderFunctionServiceRoleE83D121D": {
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM4",
              "reason": "AWS Custom resource provider lambda role created by cdk.",
            },
          ],
        },
      },
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomAuditManagerCreateDefaultReportsDestinationCustomResourceProviderHandler6BCBC433": {
      "DependsOn": [
        "CustomAuditManagerCreateDefaultReportsDestinationCustomResourceProviderRoleAEE72AE5",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomAuditManagerCreateDefaultReportsDestinationCustomResourceProviderRoleAEE72AE5",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomAuditManagerCreateDefaultReportsDestinationCustomResourceProviderLogGroupF5AC3566": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomAuditManagerCreateDefaultReportsDestinationCustomResourceProviderHandler6BCBC433",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomAuditManagerCreateDefaultReportsDestinationCustomResourceProviderRoleAEE72AE5": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "auditmanager:UpdateSettings",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "AuditManagerCreatePublishingDestinationCommandTaskAuditManagerActions",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomDetectiveCreateMembersCustomResourceProviderHandler0A0D060D": {
      "DependsOn": [
        "CustomDetectiveCreateMembersCustomResourceProviderRole90BCDD0D",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomDetectiveCreateMembersCustomResourceProviderRole90BCDD0D",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomDetectiveCreateMembersCustomResourceProviderLogGroup8A5563BD": {
      "DeletionPolicy": "Retain",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomDetectiveCreateMembersCustomResourceProviderHandler0A0D060D",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Retain",
    },
    "CustomDetectiveCreateMembersCustomResourceProviderRole90BCDD0D": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "detective:ListOrganizationAdminAccounts",
                    "detective:UpdateOrganizationConfiguration",
                    "detective:CreateMembers",
                    "detective:DeleteMembers",
                    "detective:DisassociateMembership",
                    "detective:ListMembers",
                    "detective:ListGraphs",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "DetectiveCreateMembersTaskDetectiveActions",
                },
                {
                  "Action": [
                    "iam:CreateServiceLinkedRole",
                  ],
                  "Effect": "Allow",
                  "Resource": [
                    "*",
                  ],
                  "Sid": "ServiceLinkedRoleDetective",
                },
                {
                  "Action": [
                    "organizations:ListAccounts",
                  ],
                  "Effect": "Allow",
                  "Resource": [
                    "*",
                  ],
                  "Sid": "OrganisationsListDetective",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomDetectiveUpdateGraphCustomResourceProviderHandlerD4473EC1": {
      "DependsOn": [
        "CustomDetectiveUpdateGraphCustomResourceProviderRole54CD7295",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomDetectiveUpdateGraphCustomResourceProviderRole54CD7295",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomDetectiveUpdateGraphCustomResourceProviderLogGroupDF150426": {
      "DeletionPolicy": "Retain",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomDetectiveUpdateGraphCustomResourceProviderHandlerD4473EC1",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Retain",
    },
    "CustomDetectiveUpdateGraphCustomResourceProviderRole54CD7295": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "organizations:DeregisterDelegatedAdministrator",
                    "organizations:DescribeOrganization",
                    "organizations:EnableAWSServiceAccess",
                    "organizations:ListAWSServiceAccessForOrganization",
                    "organizations:ListAccounts",
                    "organizations:ListDelegatedAdministrators",
                    "organizations:RegisterDelegatedAdministrator",
                    "organizations:ServicePrincipal",
                    "organizations:UpdateOrganizationConfiguration",
                  ],
                  "Condition": {
                    "StringLikeIfExists": {
                      "organizations:DeregisterDelegatedAdministrator": [
                        "detective.amazonaws.com",
                      ],
                      "organizations:DescribeOrganization": [
                        "detective.amazonaws.com",
                      ],
                      "organizations:EnableAWSServiceAccess": [
                        "detective.amazonaws.com",
                      ],
                      "organizations:ListAWSServiceAccessForOrganization": [
                        "detective.amazonaws.com",
                      ],
                      "organizations:ListAccounts": [
                        "detective.amazonaws.com",
                      ],
                      "organizations:ListDelegatedAdministrators": [
                        "detective.amazonaws.com",
                      ],
                      "organizations:RegisterDelegatedAdministrator": [
                        "detective.amazonaws.com",
                      ],
                      "organizations:ServicePrincipal": [
                        "detective.amazonaws.com",
                      ],
                      "organizations:UpdateOrganizationConfiguration": [
                        "detective.amazonaws.com",
                      ],
                    },
                  },
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "DetectiveConfigureOrganizationAdminAccountTaskOrganizationActions",
                },
                {
                  "Action": [
                    "detective:UpdateOrganizationConfiguration",
                    "detective:ListGraphs",
                    "detective:ListMembers",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "DetectiveUpdateGraphTaskDetectiveActions",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomGuardDutyCreateMembersCustomResourceProviderHandler0A16C673": {
      "DependsOn": [
        "CustomGuardDutyCreateMembersCustomResourceProviderRole2D82020E",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomGuardDutyCreateMembersCustomResourceProviderRole2D82020E",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomGuardDutyCreateMembersCustomResourceProviderLogGroupB5134860": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomGuardDutyCreateMembersCustomResourceProviderHandler0A16C673",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomGuardDutyCreateMembersCustomResourceProviderRole2D82020E": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "organizations:ListAccounts",
                  ],
                  "Condition": {
                    "StringLikeIfExists": {
                      "organizations:ListAccounts": [
                        "guardduty.amazonaws.com",
                      ],
                    },
                  },
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "GuardDutyCreateMembersTaskOrganizationAction",
                },
                {
                  "Action": [
                    "guardDuty:ListDetectors",
                    "guardDuty:ListOrganizationAdminAccounts",
                    "guardDuty:UpdateOrganizationConfiguration",
                    "guardduty:CreateMembers",
                    "guardduty:DeleteMembers",
                    "guardduty:DisassociateMembers",
                    "guardduty:ListDetectors",
                    "guardduty:ListMembers",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "GuardDutyCreateMembersTaskGuardDutyActions",
                },
                {
                  "Action": [
                    "iam:CreateServiceLinkedRole",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "ServiceLinkedRoleSecurityHub",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomGuardDutyUpdateDetectorCustomResourceProviderHandler78DF0FF9": {
      "DependsOn": [
        "CustomGuardDutyUpdateDetectorCustomResourceProviderRole3014073E",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomGuardDutyUpdateDetectorCustomResourceProviderRole3014073E",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomGuardDutyUpdateDetectorCustomResourceProviderLogGroup0E4B1900": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomGuardDutyUpdateDetectorCustomResourceProviderHandler78DF0FF9",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomGuardDutyUpdateDetectorCustomResourceProviderRole3014073E": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "guardduty:ListDetectors",
                    "guardduty:ListMembers",
                    "guardduty:UpdateDetector",
                    "guardduty:UpdateMemberDetectors",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "GuardDutyUpdateDetectorTaskGuardDutyActions",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomMacieCreateMemberCustomResourceProviderHandler913F75DB": {
      "DependsOn": [
        "CustomMacieCreateMemberCustomResourceProviderRole3E8977EE",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomMacieCreateMemberCustomResourceProviderRole3E8977EE",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomMacieCreateMemberCustomResourceProviderLogGroupB2DBC335": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomMacieCreateMemberCustomResourceProviderHandler913F75DB",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomMacieCreateMemberCustomResourceProviderRole3E8977EE": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "organizations:ListAccounts",
                  ],
                  "Condition": {
                    "StringLikeIfExists": {
                      "organizations:ListAccounts": [
                        "macie.amazonaws.com",
                      ],
                    },
                  },
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "MacieCreateMemberTaskOrganizationAction",
                },
                {
                  "Action": [
                    "macie2:CreateMember",
                    "macie2:DeleteMember",
                    "macie2:DescribeOrganizationConfiguration",
                    "macie2:DisassociateMember",
                    "macie2:EnableMacie",
                    "macie2:GetMacieSession",
                    "macie2:ListMembers",
                    "macie2:UpdateOrganizationConfiguration",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "MacieCreateMemberTaskMacieActions",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomS3PutBucketReplicationCustomResourceProviderHandler1D75398C": {
      "DependsOn": [
        "CustomS3PutBucketReplicationCustomResourceProviderRole1C378488",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomS3PutBucketReplicationCustomResourceProviderRole1C378488",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomS3PutBucketReplicationCustomResourceProviderLogGroup6A67905E": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomS3PutBucketReplicationCustomResourceProviderHandler1D75398C",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomS3PutBucketReplicationCustomResourceProviderRole1C378488": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "iam:PassRole",
                    "s3:PutLifecycleConfiguration",
                    "s3:PutReplicationConfiguration",
                    "s3:PutBucketVersioning",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "S3PutReplicationConfigurationTaskActions",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomSSMShareDocumentCustomResourceProviderHandler02D98C87": {
      "DependsOn": [
        "CustomSSMShareDocumentCustomResourceProviderRole53A2A3EC",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomSSMShareDocumentCustomResourceProviderRole53A2A3EC",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomSSMShareDocumentCustomResourceProviderLogGroup11AEA42B": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomSSMShareDocumentCustomResourceProviderHandler02D98C87",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomSSMShareDocumentCustomResourceProviderRole53A2A3EC": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "ssm:DescribeDocumentPermission",
                    "ssm:ModifyDocumentPermission",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":ssm:us-east-1:222222222222:document/*",
                      ],
                    ],
                  },
                  "Sid": "ShareDocumentActions",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomSecurityHubCreateMembersCustomResourceProviderHandler31D82BF3": {
      "DependsOn": [
        "CustomSecurityHubCreateMembersCustomResourceProviderRoleFD355CB6",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomSecurityHubCreateMembersCustomResourceProviderRoleFD355CB6",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomSecurityHubCreateMembersCustomResourceProviderLogGroup51212673": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomSecurityHubCreateMembersCustomResourceProviderHandler31D82BF3",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomSecurityHubCreateMembersCustomResourceProviderRoleFD355CB6": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "organizations:ListAccounts",
                  ],
                  "Condition": {
                    "StringLikeIfExists": {
                      "organizations:ListAccounts": [
                        "securityhub.amazonaws.com",
                      ],
                    },
                  },
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "SecurityHubCreateMembersTaskOrganizationAction",
                },
                {
                  "Action": [
                    "securityhub:CreateMembers",
                    "securityhub:DeleteMembers",
                    "securityhub:DisassociateMembers",
                    "securityhub:EnableSecurityHub",
                    "securityhub:ListMembers",
                    "securityhub:UpdateOrganizationConfiguration",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "SecurityHubCreateMembersTaskSecurityHubActions",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomSecurityHubRegionAggregationCustomResourceProviderHandler4B24978A": {
      "DependsOn": [
        "CustomSecurityHubRegionAggregationCustomResourceProviderRole15741044",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomSecurityHubRegionAggregationCustomResourceProviderRole15741044",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 180,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomSecurityHubRegionAggregationCustomResourceProviderLogGroup241F2158": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomSecurityHubRegionAggregationCustomResourceProviderHandler4B24978A",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomSecurityHubRegionAggregationCustomResourceProviderRole15741044": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "securityhub:CreateFindingAggregator",
                    "securityhub:UpdateFindingAggregator",
                    "securityhub:DeleteFindingAggregator",
                    "securityhub:ListFindingAggregators",
                    "securityhub:GetFindingAggregator",
                    "securityhub:DescribeHub",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "SecurityHubModifyRegionAggregation",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomSsmGetParameterValueCustomResourceProviderHandlerAAD0E7EE": {
      "DependsOn": [
        "CustomSsmGetParameterValueCustomResourceProviderRoleB3AFDDB2",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomSsmGetParameterValueCustomResourceProviderRoleB3AFDDB2",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomSsmGetParameterValueCustomResourceProviderLogGroup780D220D": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomSsmGetParameterValueCustomResourceProviderHandlerAAD0E7EE",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomSsmGetParameterValueCustomResourceProviderRoleB3AFDDB2": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "ssm:GetParameters",
                    "ssm:GetParameter",
                    "ssm:DescribeParameters",
                  ],
                  "Effect": "Allow",
                  "Resource": [
                    "*",
                  ],
                  "Sid": "SsmGetParameterActions",
                },
                {
                  "Action": [
                    "sts:AssumeRole",
                  ],
                  "Effect": "Allow",
                  "Resource": [
                    {
                      "Fn::Join": [
                        "",
                        [
                          "arn:",
                          {
                            "Ref": "AWS::Partition",
                          },
                          ":iam::*:role/AWSAccelerator*",
                        ],
                      ],
                    },
                  ],
                  "Sid": "StsAssumeRoleActions",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "DetectiveGraphConfig248C4B9F": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomDetectiveUpdateGraphCustomResourceProviderLogGroupDF150426",
        "DetectiveMembers42A16137",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomDetectiveUpdateGraphCustomResourceProviderHandlerD4473EC1",
            "Arn",
          ],
        },
        "region": "us-east-1",
      },
      "Type": "Custom::DetectiveUpdateGraph",
      "UpdateReplacePolicy": "Delete",
    },
    "DetectiveMembers42A16137": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomDetectiveCreateMembersCustomResourceProviderLogGroup8A5563BD",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomDetectiveCreateMembersCustomResourceProviderHandler0A0D060D",
            "Arn",
          ],
        },
        "partition": {
          "Ref": "AWS::Partition",
        },
        "region": "us-east-1",
      },
      "Type": "Custom::DetectiveCreateMembers",
      "UpdateReplacePolicy": "Delete",
    },
    "GuardDutyDetectorConfigDD64B103": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomGuardDutyUpdateDetectorCustomResourceProviderLogGroup0E4B1900",
        "GuardDutyMembersD34CA003",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomGuardDutyUpdateDetectorCustomResourceProviderHandler78DF0FF9",
            "Arn",
          ],
        },
        "enableEksProtection": true,
        "enableS3Protection": true,
        "exportFrequency": "FIFTEEN_MINUTES",
        "region": "us-east-1",
      },
      "Type": "Custom::GuardDutyUpdateDetector",
      "UpdateReplacePolicy": "Delete",
    },
    "GuardDutyMembersD34CA003": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomGuardDutyCreateMembersCustomResourceProviderLogGroupB5134860",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomGuardDutyCreateMembersCustomResourceProviderHandler0A16C673",
            "Arn",
          ],
        },
        "enableEksProtection": true,
        "enableS3Protection": true,
        "partition": {
          "Ref": "AWS::Partition",
        },
        "region": "us-east-1",
      },
      "Type": "Custom::GuardDutyCreateMembers",
      "UpdateReplacePolicy": "Delete",
    },
    "HighSnsTopicF69104E5": {
      "Properties": {
        "DisplayName": "AWS Accelerator - High Notifications",
        "KmsMasterKeyId": {
          "Fn::GetAtt": [
            "AcceleratorSnsKeyDADF94B1",
            "Arn",
          ],
        },
        "TopicName": "aws-accelerator-HighNotifications",
      },
      "Type": "AWS::SNS::Topic",
    },
    "HighSnsTopicPolicy59BE4137": {
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "sns:Publish",
              "Effect": "Allow",
              "Principal": {
                "Service": "cloudwatch.amazonaws.com",
              },
              "Resource": {
                "Ref": "HighSnsTopicF69104E5",
              },
              "Sid": "0",
            },
            {
              "Action": "sns:Publish",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
              "Resource": {
                "Ref": "HighSnsTopicF69104E5",
              },
              "Sid": "1",
            },
            {
              "Action": "sns:Publish",
              "Condition": {
                "StringEquals": {
                  "aws:PrincipalOrgID": "o-asdf123456",
                },
              },
              "Effect": "Allow",
              "Principal": {
                "AWS": "*",
              },
              "Resource": {
                "Ref": "HighSnsTopicF69104E5",
              },
              "Sid": "2",
            },
            {
              "Action": [
                "sns:ListSubscriptionsByTopic",
                "sns:ListTagsForResource",
                "sns:GetTopicAttributes",
              ],
              "Condition": {
                "StringEquals": {
                  "aws:PrincipalOrgID": "o-asdf123456",
                },
              },
              "Effect": "Allow",
              "Principal": {
                "AWS": "*",
              },
              "Resource": {
                "Ref": "HighSnsTopicF69104E5",
              },
              "Sid": "Allow Organization list topic",
            },
          ],
          "Version": "2012-10-17",
        },
        "Topics": [
          {
            "Ref": "HighSnsTopicF69104E5",
          },
        ],
      },
      "Type": "AWS::SNS::TopicPolicy",
    },
    "HighSnsTopicnotifyhighexamplecomD3D4C272": {
      "Properties": {
        "Endpoint": "notify-high@example.com",
        "Protocol": "email",
        "TopicArn": {
          "Ref": "HighSnsTopicF69104E5",
        },
      },
      "Type": "AWS::SNS::Subscription",
    },
    "LowSnsTopic53AD0F18": {
      "Properties": {
        "DisplayName": "AWS Accelerator - Low Notifications",
        "KmsMasterKeyId": {
          "Fn::GetAtt": [
            "AcceleratorSnsKeyDADF94B1",
            "Arn",
          ],
        },
        "TopicName": "aws-accelerator-LowNotifications",
      },
      "Type": "AWS::SNS::Topic",
    },
    "LowSnsTopicPolicy0C1FEB12": {
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "sns:Publish",
              "Effect": "Allow",
              "Principal": {
                "Service": "cloudwatch.amazonaws.com",
              },
              "Resource": {
                "Ref": "LowSnsTopic53AD0F18",
              },
              "Sid": "0",
            },
            {
              "Action": "sns:Publish",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
              "Resource": {
                "Ref": "LowSnsTopic53AD0F18",
              },
              "Sid": "1",
            },
            {
              "Action": "sns:Publish",
              "Condition": {
                "StringEquals": {
                  "aws:PrincipalOrgID": "o-asdf123456",
                },
              },
              "Effect": "Allow",
              "Principal": {
                "AWS": "*",
              },
              "Resource": {
                "Ref": "LowSnsTopic53AD0F18",
              },
              "Sid": "2",
            },
            {
              "Action": [
                "sns:ListSubscriptionsByTopic",
                "sns:ListTagsForResource",
                "sns:GetTopicAttributes",
              ],
              "Condition": {
                "StringEquals": {
                  "aws:PrincipalOrgID": "o-asdf123456",
                },
              },
              "Effect": "Allow",
              "Principal": {
                "AWS": "*",
              },
              "Resource": {
                "Ref": "LowSnsTopic53AD0F18",
              },
              "Sid": "Allow Organization list topic",
            },
          ],
          "Version": "2012-10-17",
        },
        "Topics": [
          {
            "Ref": "LowSnsTopic53AD0F18",
          },
        ],
      },
      "Type": "AWS::SNS::TopicPolicy",
    },
    "LowSnsTopicnotifylowexamplecom00FF09F7": {
      "Properties": {
        "Endpoint": "notify-low@example.com",
        "Protocol": "email",
        "TopicArn": {
          "Ref": "LowSnsTopic53AD0F18",
        },
      },
      "Type": "AWS::SNS::Subscription",
    },
    "MacieMembers1B6840B4": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomMacieCreateMemberCustomResourceProviderLogGroupB2DBC335",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomMacieCreateMemberCustomResourceProviderHandler913F75DB",
            "Arn",
          ],
        },
        "adminAccountId": "222222222222",
        "partition": {
          "Ref": "AWS::Partition",
        },
        "region": "us-east-1",
      },
      "Type": "Custom::MacieCreateMember",
      "UpdateReplacePolicy": "Delete",
    },
    "MediumSnsTopic267CAB5B": {
      "Properties": {
        "DisplayName": "AWS Accelerator - Medium Notifications",
        "KmsMasterKeyId": {
          "Fn::GetAtt": [
            "AcceleratorSnsKeyDADF94B1",
            "Arn",
          ],
        },
        "TopicName": "aws-accelerator-MediumNotifications",
      },
      "Type": "AWS::SNS::Topic",
    },
    "MediumSnsTopicPolicy0B54F62B": {
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "sns:Publish",
              "Effect": "Allow",
              "Principal": {
                "Service": "cloudwatch.amazonaws.com",
              },
              "Resource": {
                "Ref": "MediumSnsTopic267CAB5B",
              },
              "Sid": "0",
            },
            {
              "Action": "sns:Publish",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
              "Resource": {
                "Ref": "MediumSnsTopic267CAB5B",
              },
              "Sid": "1",
            },
            {
              "Action": "sns:Publish",
              "Condition": {
                "StringEquals": {
                  "aws:PrincipalOrgID": "o-asdf123456",
                },
              },
              "Effect": "Allow",
              "Principal": {
                "AWS": "*",
              },
              "Resource": {
                "Ref": "MediumSnsTopic267CAB5B",
              },
              "Sid": "2",
            },
            {
              "Action": [
                "sns:ListSubscriptionsByTopic",
                "sns:ListTagsForResource",
                "sns:GetTopicAttributes",
              ],
              "Condition": {
                "StringEquals": {
                  "aws:PrincipalOrgID": "o-asdf123456",
                },
              },
              "Effect": "Allow",
              "Principal": {
                "AWS": "*",
              },
              "Resource": {
                "Ref": "MediumSnsTopic267CAB5B",
              },
              "Sid": "Allow Organization list topic",
            },
          ],
          "Version": "2012-10-17",
        },
        "Topics": [
          {
            "Ref": "MediumSnsTopic267CAB5B",
          },
        ],
      },
      "Type": "AWS::SNS::TopicPolicy",
    },
    "MediumSnsTopicnotifymediumexamplecom8D67BD3D": {
      "Properties": {
        "Endpoint": "notify-medium@example.com",
        "Protocol": "email",
        "TopicArn": {
          "Ref": "MediumSnsTopic267CAB5B",
        },
      },
      "Type": "AWS::SNS::Subscription",
    },
    "PutS3Encryption383DF0CE": {
      "Properties": {
        "Content": {
          "assumeRole": "{{ AutomationAssumeRole }}",
          "description": "Enables Encryption on S3 Bucket",
          "mainSteps": [
            {
              "action": "aws:executeAwsApi",
              "inputs": {
                "Api": "PutBucketEncryption",
                "Bucket": "{{BucketName}}",
                "ServerSideEncryptionConfiguration": {
                  "Rules": [
                    {
                      "ApplyServerSideEncryptionByDefault": {
                        "KMSMasterKeyID": "{{KMSMasterKey}}",
                        "SSEAlgorithm": "aws:kms",
                      },
                    },
                  ],
                },
                "Service": "s3",
              },
              "isEnd": true,
              "name": "PutBucketEncryption",
            },
          ],
          "parameters": {
            "AutomationAssumeRole": {
              "default": "",
              "description": "(Optional) The ARN of the role that allows Automation to perform the actions on your behalf.",
              "type": "String",
            },
            "BucketName": {
              "description": "(Required) The name of the S3 Bucket whose content will be encrypted.",
              "type": "String",
            },
            "KMSMasterKey": {
              "description": "(Optional) AWS Key Management Service (KMS) customer master key ARN to use for the default encryption.",
              "type": "String",
            },
          },
          "schemaVersion": "0.3",
        },
        "DocumentType": "Automation",
        "Name": "Put-S3-Encryption",
        "UpdateMethod": "NewVersion",
      },
      "Type": "AWS::SSM::Document",
    },
    "PutS3EncryptionShareDocumentF7F3A94E": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomSSMShareDocumentCustomResourceProviderLogGroup11AEA42B",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomSSMShareDocumentCustomResourceProviderHandler02D98C87",
            "Arn",
          ],
        },
        "accountIds": [
          "111111111111",
          "333333333333",
          "222222222222",
          "444444444444",
          "555555555555",
          "666666666666",
        ],
        "name": {
          "Ref": "PutS3Encryption383DF0CE",
        },
      },
      "Type": "Custom::SSMShareDocument",
      "UpdateReplacePolicy": "Delete",
    },
    "SecurityHubMembers2A2B77C4": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomSecurityHubCreateMembersCustomResourceProviderLogGroup51212673",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomSecurityHubCreateMembersCustomResourceProviderHandler31D82BF3",
            "Arn",
          ],
        },
        "partition": {
          "Ref": "AWS::Partition",
        },
        "region": "us-east-1",
      },
      "Type": "Custom::SecurityHubCreateMembers",
      "UpdateReplacePolicy": "Delete",
    },
    "SecurityHubRegionAggregation0CC69E1B": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomSecurityHubRegionAggregationCustomResourceProviderLogGroup241F2158",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomSecurityHubRegionAggregationCustomResourceProviderHandler4B24978A",
            "Arn",
          ],
        },
        "partition": {
          "Ref": "AWS::Partition",
        },
        "region": "us-east-1",
      },
      "Type": "Custom::SecurityHubRegionAggregation",
      "UpdateReplacePolicy": "Delete",
    },
    "SsmElbEnableLoggingDB91F105": {
      "Properties": {
        "Content": {
          "assumeRole": "{{ AutomationAssumeRole }}",
          "description": "Enable logging on Elastic Load-Balancer",
          "mainSteps": [
            {
              "action": "aws:executeAwsApi",
              "inputs": {
                "Api": "get_caller_identity",
                "Service": "sts",
              },
              "name": "getAccount",
              "outputs": [
                {
                  "Name": "Id",
                  "Selector": "$.Account",
                  "Type": "String",
                },
              ],
            },
            {
              "action": "aws:executeAwsApi",
              "inputs": {
                "Api": "describe_load_balancers",
                "LoadBalancerArns": [
                  "{{ LoadBalancerArn }}",
                ],
                "Service": "elbv2",
              },
              "name": "getLoadBalancer",
              "outputs": [
                {
                  "Name": "Name",
                  "Selector": "$.LoadBalancers[0].LoadBalancerName",
                  "Type": "String",
                },
              ],
            },
            {
              "action": "aws:executeAwsApi",
              "inputs": {
                "Api": "modify_load_balancer_attributes",
                "Attributes": [
                  {
                    "Key": "access_logs.s3.enabled",
                    "Value": "true",
                  },
                  {
                    "Key": "access_logs.s3.bucket",
                    "Value": "{{ LogDestination }}",
                  },
                  {
                    "Key": "access_logs.s3.prefix",
                    "Value": "elb/elb-{{ getLoadBalancer.Name }}/{{ getAccount.Id }}",
                  },
                ],
                "LoadBalancerArn": "{{ LoadBalancerArn }}",
                "Service": "elbv2",
              },
              "name": "enableLogging",
            },
          ],
          "parameters": {
            "AutomationAssumeRole": {
              "type": "String",
            },
            "LoadBalancerArn": {
              "type": "String",
            },
            "LogDestination": {
              "type": "String",
            },
          },
          "schemaVersion": "0.3",
        },
        "DocumentType": "Automation",
        "Name": "SSM-ELB-Enable-Logging",
        "UpdateMethod": "NewVersion",
      },
      "Type": "AWS::SSM::Document",
    },
    "SsmElbEnableLoggingShareDocument16727B30": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomSSMShareDocumentCustomResourceProviderLogGroup11AEA42B",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomSSMShareDocumentCustomResourceProviderHandler02D98C87",
            "Arn",
          ],
        },
        "accountIds": [
          "111111111111",
          "333333333333",
          "222222222222",
          "444444444444",
          "555555555555",
          "666666666666",
        ],
        "name": {
          "Ref": "SsmElbEnableLoggingDB91F105",
        },
      },
      "Type": "Custom::SSMShareDocument",
      "UpdateReplacePolicy": "Delete",
    },
    "SsmParamAcceleratorVersionFF83282D": {
      "Properties": {
        "Name": "/accelerator/AWSAccelerator-SecurityAuditStack-222222222222-us-east-1/version",
        "Type": "String",
        "Value": "1.4.3",
      },
      "Type": "AWS::SSM::Parameter",
    },
    "SsmParamOrganizationAuditManagerPublishingDestinationBucketArn488415E7": {
      "Properties": {
        "Name": "/accelerator/organization/security/auditManager/publishing-destination/bucket-arn",
        "Type": "String",
        "Value": {
          "Fn::GetAtt": [
            "AuditManagerPublishingDestinationBucket74974FCF",
            "Arn",
          ],
        },
      },
      "Type": "AWS::SSM::Parameter",
    },
    "SsmParamStackId521A78D3": {
      "Properties": {
        "Name": "/accelerator/AWSAccelerator-SecurityAuditStack-222222222222-us-east-1/stack-id",
        "Type": "String",
        "Value": {
          "Ref": "AWS::StackId",
        },
      },
      "Type": "AWS::SSM::Parameter",
    },
    "WafEnableLoggingB6AE5B82": {
      "Properties": {
        "Content": {
          "assumeRole": "{{ AutomationAssumeRole }}",
          "description": "Adds logging to non-compliant WebACLs",
          "mainSteps": [
            {
              "action": "aws:executeScript",
              "inputs": {
                "Handler": "handler",
                "InputPayload": {
                  "WebACLId": "{{ WebACLId }}",
                },
                "Runtime": "python3.7",
                "Script": "REPLACED-JSON-PATH.json",
              },
              "name": "performRemediation",
            },
          ],
          "parameters": {
            "AutomationAssumeRole": {
              "type": "String",
            },
            "WebACLId": {
              "type": "String",
            },
          },
          "schemaVersion": "0.3",
        },
        "DocumentType": "Automation",
        "Name": "WAF-Enable-Logging",
        "UpdateMethod": "NewVersion",
      },
      "Type": "AWS::SSM::Document",
    },
    "WafEnableLoggingShareDocument11FB34C8": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomSSMShareDocumentCustomResourceProviderLogGroup11AEA42B",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomSSMShareDocumentCustomResourceProviderHandler02D98C87",
            "Arn",
          ],
        },
        "accountIds": [
          "111111111111",
          "333333333333",
          "222222222222",
          "444444444444",
          "555555555555",
          "666666666666",
        ],
        "name": {
          "Ref": "WafEnableLoggingB6AE5B82",
        },
      },
      "Type": "Custom::SSMShareDocument",
      "UpdateReplacePolicy": "Delete",
    },
  },
}
`;

exports[`delegatedAdminStack Construct(SecurityAuditStack):  Snapshot Test 1`] = `
{
  "Parameters": {
    "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter": {
      "Default": "/accelerator/kms/cloudwatch/key-arn",
      "Type": "AWS::SSM::Parameter::Value<String>",
    },
    "SsmParameterValueacceleratorkmss3keyarnC96584B6F00A464EAD1953AFF4B05118Parameter": {
      "Default": "/accelerator/kms/s3/key-arn",
      "Type": "AWS::SSM::Parameter::Value<String>",
    },
  },
  "Resources": {
    "AccessAnalyzer": {
      "Properties": {
        "Type": "ORGANIZATION",
      },
      "Type": "AWS::AccessAnalyzer::Analyzer",
    },
    "AttachIamInstanceProfileC858EC06": {
      "Properties": {
        "Content": {
          "assumeRole": "{{ AutomationAssumeRole }}",
          "description": "Associate AWS Iam Instance Profile to EC2 Instance",
          "mainSteps": [
            {
              "action": "aws:executeAwsApi",
              "inputs": {
                "Api": "associate_iam_instance_profile",
                "IamInstanceProfile": {
                  "Name": "{{ IamInstanceProfile }}",
                },
                "InstanceId": "{{ InstanceId }}",
                "Service": "ec2",
              },
              "name": "associateIamProfile",
            },
          ],
          "parameters": {
            "AutomationAssumeRole": {
              "type": "String",
            },
            "IamInstanceProfile": {
              "type": "String",
            },
            "InstanceId": {
              "type": "String",
            },
          },
          "schemaVersion": "0.3",
        },
        "DocumentType": "Automation",
        "Name": "Attach-IAM-Instance-Profile",
        "UpdateMethod": "NewVersion",
      },
      "Type": "AWS::SSM::Document",
    },
    "AttachIamInstanceProfileShareDocumentD1F87A43": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomSSMShareDocumentCustomResourceProviderLogGroup11AEA42B",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomSSMShareDocumentCustomResourceProviderHandler02D98C87",
            "Arn",
          ],
        },
        "accountIds": [
          "111111111111",
          "333333333333",
          "222222222222",
          "444444444444",
          "555555555555",
          "666666666666",
        ],
        "name": {
          "Ref": "AttachIamInstanceProfileC858EC06",
        },
      },
      "Type": "Custom::SSMShareDocument",
      "UpdateReplacePolicy": "Delete",
    },
    "AttachIamRolePolicy19A43F7E": {
      "Properties": {
        "Content": {
          "assumeRole": "{{ AutomationAssumeRole }}",
          "description": "IAM Role Policy",
          "mainSteps": [
            {
              "action": "aws:executeScript",
              "inputs": {
                "Handler": "script_handler",
                "InputPayload": {
                  "AWSManagedPolicies": "{{ AWSManagedPolicies }}",
                  "CustomerManagedPolicies": "{{ CustomerManagedPolicies }}",
                  "ResourceId": "{{ ResourceId }}",
                },
                "Runtime": "python3.7",
                "Script": "import boto3
partition = boto3.client("sts").get_caller_identity()['Arn'].split(":")[1]
iam = boto3.client("iam")
config = boto3.client("config")
def script_handler(events, context):
  resource_id = events["ResourceId"]
  response = config.batch_get_resource_config(
    resourceKeys=[{
      'resourceType': 'AWS::IAM::Role',
      'resourceId': resource_id
    }]
  )
  role_name = response["baseConfigurationItems"][0]['resourceName']
  aws_policy_names = events["AWSManagedPolicies"]
  customer_policy_names = events["CustomerManagedPolicies"]
  for policy in aws_policy_names:
    iam.attach_role_policy(
      PolicyArn="arn:%s:iam::aws:policy/%s" %(partition, policy),
      RoleName=role_name
    )
  for policy in customer_policy_names:
    iam.attach_role_policy(
      PolicyArn=policy,
      RoleName=role_name
    )",
              },
              "name": "attachPolicy",
            },
          ],
          "parameters": {
            "AWSManagedPolicies": {
              "type": "StringList",
            },
            "AutomationAssumeRole": {
              "type": "String",
            },
            "CustomerManagedPolicies": {
              "default": [],
              "minItems": 0,
              "type": "StringList",
            },
            "ResourceId": {
              "type": "String",
            },
          },
          "schemaVersion": "0.3",
        },
        "DocumentType": "Automation",
        "Name": "Attach-IAM-Role-Policy",
        "UpdateMethod": "NewVersion",
      },
      "Type": "AWS::SSM::Document",
    },
    "AttachIamRolePolicyShareDocumentF5C9E6C7": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomSSMShareDocumentCustomResourceProviderLogGroup11AEA42B",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomSSMShareDocumentCustomResourceProviderHandler02D98C87",
            "Arn",
          ],
        },
        "accountIds": [
          "111111111111",
          "333333333333",
          "222222222222",
          "444444444444",
          "555555555555",
          "666666666666",
        ],
        "name": {
          "Ref": "AttachIamRolePolicy19A43F7E",
        },
      },
      "Type": "Custom::SSMShareDocument",
      "UpdateReplacePolicy": "Delete",
    },
    "AuditManagerDefaultReportsDestinationAFD20D60": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomAuditManagerCreateDefaultReportsDestinationCustomResourceProviderLogGroupF5AC3566",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomAuditManagerCreateDefaultReportsDestinationCustomResourceProviderHandler6BCBC433",
            "Arn",
          ],
        },
        "bucket": {
          "Fn::Join": [
            "",
            [
              "s3://'",
              {
                "Ref": "AuditManagerPublishingDestinationBucket74974FCF",
              },
              "/audit-manager/222222222222/",
            ],
          ],
        },
        "defaultReportsDestinationType": "S3",
        "kmsKeyArn": {
          "Ref": "SsmParameterValueacceleratorkmss3keyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "region": "us-east-1",
      },
      "Type": "Custom::AuditManagerCreateDefaultReportsDestination",
      "UpdateReplacePolicy": "Delete",
    },
    "AuditManagerPublishingDestinationBucket74974FCF": {
      "DeletionPolicy": "Retain",
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-S1",
              "reason": "AuditManagerPublishingDestinationBucket has server access logs disabled till the task for access logging completed.",
            },
          ],
        },
      },
      "Properties": {
        "BucketEncryption": {
          "ServerSideEncryptionConfiguration": [
            {
              "ServerSideEncryptionByDefault": {
                "KMSMasterKeyID": {
                  "Ref": "SsmParameterValueacceleratorkmss3keyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
                },
                "SSEAlgorithm": "aws:kms",
              },
            },
          ],
        },
        "BucketName": {
          "Fn::Join": [
            "",
            [
              "aws-accelerator-auditmgr-",
              {
                "Ref": "AWS::AccountId",
              },
              "-",
              {
                "Ref": "AWS::Region",
              },
            ],
          ],
        },
        "LoggingConfiguration": {
          "DestinationBucketName": {
            "Fn::Join": [
              "",
              [
                "aws-accelerator-s3-access-logs-",
                {
                  "Ref": "AWS::AccountId",
                },
                "-",
                {
                  "Ref": "AWS::Region",
                },
              ],
            ],
          },
        },
        "OwnershipControls": {
          "Rules": [
            {
              "ObjectOwnership": "BucketOwnerPreferred",
            },
          ],
        },
        "PublicAccessBlockConfiguration": {
          "BlockPublicAcls": true,
          "BlockPublicPolicy": true,
          "IgnorePublicAcls": true,
          "RestrictPublicBuckets": true,
        },
        "Tags": [
          {
            "Key": "aws-cdk:auto-audit-manager-access-bucket",
            "Value": "true",
          },
          {
            "Key": "aws-cdk:auto-auditManager-access-bucket",
            "Value": "true",
          },
        ],
        "VersioningConfiguration": {
          "Status": "Enabled",
        },
      },
      "Type": "AWS::S3::Bucket",
      "UpdateReplacePolicy": "Retain",
    },
    "AuditManagerPublishingDestinationBucketAuditManagerPublishingDestinationBucketReplicationAwsAcceleratorCentralLogs333333333333UsWest2ReplicationRoleDefaultPolicy6D87750E": {
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "Allows only specific policy.",
            },
          ],
        },
      },
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "s3:GetObjectLegalHold",
                "s3:GetObjectRetention",
                "s3:GetObjectVersion",
                "s3:GetObjectVersionAcl",
                "s3:GetObjectVersionForReplication",
                "s3:GetObjectVersionTagging",
                "s3:GetReplicationConfiguration",
                "s3:ListBucket",
                "s3:ReplicateDelete",
                "s3:ReplicateObject",
                "s3:ReplicateTags",
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "AuditManagerPublishingDestinationBucket74974FCF",
                    "Arn",
                  ],
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "AuditManagerPublishingDestinationBucket74974FCF",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
            {
              "Action": [
                "s3:GetBucketVersioning",
                "s3:GetObjectVersionTagging",
                "s3:ObjectOwnerOverrideToBucketOwner",
                "s3:PutBucketVersioning",
                "s3:ReplicateDelete",
                "s3:ReplicateObject",
                "s3:ReplicateTags",
              ],
              "Effect": "Allow",
              "Resource": {
                "Fn::Join": [
                  "",
                  [
                    "arn:",
                    {
                      "Ref": "AWS::Partition",
                    },
                    ":s3:::aws-accelerator-central-logs-333333333333-us-west-2/*",
                  ],
                ],
              },
            },
            {
              "Action": "kms:Decrypt",
              "Effect": "Allow",
              "Resource": {
                "Ref": "SsmParameterValueacceleratorkmss3keyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
              },
            },
            {
              "Action": "kms:Encrypt",
              "Effect": "Allow",
              "Resource": {
                "Ref": "CentralLogsBucketKeyLookup52CD8A37",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ditManagerPublishingDestinationBucketReplicationAwsAcceleratorCentralLogs333333333333UsWest2ReplicationRoleDefaultPolicy6D87750E",
        "Roles": [
          {
            "Ref": "AuditManagerPublishingDestinationBucketAuditManagerPublishingDestinationBucketReplicationAwsAcceleratorCentralLogs333333333333UsWest2ReplicationRoleE0509DD9",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "AuditManagerPublishingDestinationBucketAuditManagerPublishingDestinationBucketReplicationAwsAcceleratorCentralLogs333333333333UsWest2ReplicationRoleE0509DD9": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "s3.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "Path": "/service-role/",
        "Tags": [
          {
            "Key": "aws-cdk:auto-audit-manager-access-bucket",
            "Value": "true",
          },
          {
            "Key": "aws-cdk:auto-auditManager-access-bucket",
            "Value": "true",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "AuditManagerPublishingDestinationBucketAuditManagerPublishingDestinationBucketReplicationECF1B287": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomS3PutBucketReplicationCustomResourceProviderLogGroup6A67905E",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomS3PutBucketReplicationCustomResourceProviderHandler1D75398C",
            "Arn",
          ],
        },
        "destinationAccountId": "333333333333",
        "destinationBucketArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition",
              },
              ":s3:::aws-accelerator-central-logs-333333333333-us-west-2",
            ],
          ],
        },
        "destinationBucketKeyArn": {
          "Ref": "CentralLogsBucketKeyLookup52CD8A37",
        },
        "prefix": "",
        "replicationRoleArn": {
          "Fn::GetAtt": [
            "AuditManagerPublishingDestinationBucketAuditManagerPublishingDestinationBucketReplicationAwsAcceleratorCentralLogs333333333333UsWest2ReplicationRoleE0509DD9",
            "Arn",
          ],
        },
        "sourceBucketName": {
          "Ref": "AuditManagerPublishingDestinationBucket74974FCF",
        },
      },
      "Type": "Custom::S3PutBucketReplication",
      "UpdateReplacePolicy": "Delete",
    },
    "AuditManagerPublishingDestinationBucketPolicy3992854B": {
      "Properties": {
        "Bucket": {
          "Ref": "AuditManagerPublishingDestinationBucket74974FCF",
        },
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "s3:*",
              "Condition": {
                "Bool": {
                  "aws:SecureTransport": "false",
                },
              },
              "Effect": "Deny",
              "Principal": {
                "AWS": "*",
              },
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "AuditManagerPublishingDestinationBucket74974FCF",
                    "Arn",
                  ],
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "AuditManagerPublishingDestinationBucket74974FCF",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
              "Sid": "deny-insecure-connections",
            },
            {
              "Action": [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
                "s3:DeleteObject*",
                "s3:PutObject",
                "s3:PutObjectLegalHold",
                "s3:PutObjectRetention",
                "s3:PutObjectTagging",
                "s3:PutObjectVersionTagging",
                "s3:Abort*",
              ],
              "Effect": "Allow",
              "Principal": {
                "Service": "auditmanager.amazonaws.com",
              },
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "AuditManagerPublishingDestinationBucket74974FCF",
                    "Arn",
                  ],
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "AuditManagerPublishingDestinationBucket74974FCF",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
            },
            {
              "Action": [
                "s3:GetBucketLocation",
                "s3:PutObject",
              ],
              "Condition": {
                "StringEquals": {
                  "aws:PrincipalOrgID": "o-asdf123456",
                },
              },
              "Effect": "Allow",
              "Principal": {
                "AWS": "*",
              },
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "AuditManagerPublishingDestinationBucket74974FCF",
                    "Arn",
                  ],
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "AuditManagerPublishingDestinationBucket74974FCF",
                          "Arn",
                        ],
                      },
                      "/*",
                    ],
                  ],
                },
              ],
              "Sid": "Allow Organization principals to use of the bucket",
            },
          ],
          "Version": "2012-10-17",
        },
      },
      "Type": "AWS::S3::BucketPolicy",
    },
    "CentralLogsBucketKeyLookup52CD8A37": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomSsmGetParameterValueCustomResourceProviderLogGroup780D220D",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomSsmGetParameterValueCustomResourceProviderHandlerAAD0E7EE",
            "Arn",
          ],
        },
        "assumeRoleArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition",
              },
              ":iam::333333333333:role/AWSAccelerator-CentralBucket-KeyArnParam-Role",
            ],
          ],
        },
        "invokingAccountID": "222222222222",
        "invokingRegion": "us-east-1",
        "parameterAccountID": "333333333333",
        "parameterName": "/accelerator/logging/central-bucket/kms/arn",
        "parameterRegion": "us-west-2",
        "uuid": "REPLACED-UUID",
      },
      "Type": "Custom::SsmGetParameterValue",
      "UpdateReplacePolicy": "Delete",
    },
    "ControlTowerNotificationsForwarderFunctionAllowInvokeAWSAcceleratorSecurityAuditStack222222222222useast1ControlTowerSNSTopic2C923A0CF50B8C0E": {
      "Properties": {
        "Action": "lambda:InvokeFunction",
        "FunctionName": {
          "Fn::GetAtt": [
            "ControlTowerNotificationsForwarderFunctionFA79B131",
            "Arn",
          ],
        },
        "Principal": "sns.amazonaws.com",
        "SourceArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition",
              },
              ":sns:us-east-1:222222222222:aws-controltower-AggregateSecurityNotifications",
            ],
          ],
        },
      },
      "Type": "AWS::Lambda::Permission",
    },
    "ControlTowerNotificationsForwarderFunctionControlTowerSNSTopicF1309D6C": {
      "Properties": {
        "Endpoint": {
          "Fn::GetAtt": [
            "ControlTowerNotificationsForwarderFunctionFA79B131",
            "Arn",
          ],
        },
        "Protocol": "lambda",
        "Region": "us-east-1",
        "TopicArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition",
              },
              ":sns:us-east-1:222222222222:aws-controltower-AggregateSecurityNotifications",
            ],
          ],
        },
      },
      "Type": "AWS::SNS::Subscription",
    },
    "ControlTowerNotificationsForwarderFunctionFA79B131": {
      "DependsOn": [
        "ControlTowerNotificationsForwarderFunctionServiceRoleDefaultPolicyEBACE9AF",
        "ControlTowerNotificationsForwarderFunctionServiceRoleE83D121D",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Description": "Lambda function to forward ControlTower notifications to management account",
        "Environment": {
          "Variables": {
            "SNS_TOPIC_ARN": {
              "Fn::Join": [
                "",
                [
                  "arn:",
                  {
                    "Ref": "AWS::Partition",
                  },
                  ":sns:us-east-1:111111111111:aws-accelerator-ControlTowerNotification",
                ],
              ],
            },
          },
        },
        "Handler": "index.handler",
        "Role": {
          "Fn::GetAtt": [
            "ControlTowerNotificationsForwarderFunctionServiceRoleE83D121D",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 120,
      },
      "Type": "AWS::Lambda::Function",
    },
    "ControlTowerNotificationsForwarderFunctionServiceRoleDefaultPolicyEBACE9AF": {
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM5",
              "reason": "Require access to all keys in management account",
            },
          ],
        },
      },
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "sns:Publish",
              "Effect": "Allow",
              "Resource": {
                "Fn::Join": [
                  "",
                  [
                    "arn:",
                    {
                      "Ref": "AWS::Partition",
                    },
                    ":sns:us-east-1:111111111111:aws-accelerator-ControlTowerNotification",
                  ],
                ],
              },
              "Sid": "sns",
            },
            {
              "Action": [
                "kms:DescribeKey",
                "kms:GenerateDataKey",
                "kms:Decrypt",
                "kms:Encrypt",
              ],
              "Effect": "Allow",
              "Resource": {
                "Fn::Join": [
                  "",
                  [
                    "arn:",
                    {
                      "Ref": "AWS::Partition",
                    },
                    ":kms:us-east-1:111111111111:key/*",
                  ],
                ],
              },
              "Sid": "kms",
            },
          ],
          "Version": "2012-10-17",
        },
        "PolicyName": "ControlTowerNotificationsForwarderFunctionServiceRoleDefaultPolicyEBACE9AF",
        "Roles": [
          {
            "Ref": "ControlTowerNotificationsForwarderFunctionServiceRoleE83D121D",
          },
        ],
      },
      "Type": "AWS::IAM::Policy",
    },
    "ControlTowerNotificationsForwarderFunctionServiceRoleE83D121D": {
      "Metadata": {
        "cdk_nag": {
          "rules_to_suppress": [
            {
              "id": "AwsSolutions-IAM4",
              "reason": "AWS Custom resource provider lambda role created by cdk.",
            },
          ],
        },
      },
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition",
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
              ],
            ],
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomAuditManagerCreateDefaultReportsDestinationCustomResourceProviderHandler6BCBC433": {
      "DependsOn": [
        "CustomAuditManagerCreateDefaultReportsDestinationCustomResourceProviderRoleAEE72AE5",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomAuditManagerCreateDefaultReportsDestinationCustomResourceProviderRoleAEE72AE5",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomAuditManagerCreateDefaultReportsDestinationCustomResourceProviderLogGroupF5AC3566": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomAuditManagerCreateDefaultReportsDestinationCustomResourceProviderHandler6BCBC433",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomAuditManagerCreateDefaultReportsDestinationCustomResourceProviderRoleAEE72AE5": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "auditmanager:UpdateSettings",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "AuditManagerCreatePublishingDestinationCommandTaskAuditManagerActions",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomDetectiveCreateMembersCustomResourceProviderHandler0A0D060D": {
      "DependsOn": [
        "CustomDetectiveCreateMembersCustomResourceProviderRole90BCDD0D",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomDetectiveCreateMembersCustomResourceProviderRole90BCDD0D",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomDetectiveCreateMembersCustomResourceProviderLogGroup8A5563BD": {
      "DeletionPolicy": "Retain",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomDetectiveCreateMembersCustomResourceProviderHandler0A0D060D",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Retain",
    },
    "CustomDetectiveCreateMembersCustomResourceProviderRole90BCDD0D": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "detective:ListOrganizationAdminAccounts",
                    "detective:UpdateOrganizationConfiguration",
                    "detective:CreateMembers",
                    "detective:DeleteMembers",
                    "detective:DisassociateMembership",
                    "detective:ListMembers",
                    "detective:ListGraphs",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "DetectiveCreateMembersTaskDetectiveActions",
                },
                {
                  "Action": [
                    "iam:CreateServiceLinkedRole",
                  ],
                  "Effect": "Allow",
                  "Resource": [
                    "*",
                  ],
                  "Sid": "ServiceLinkedRoleDetective",
                },
                {
                  "Action": [
                    "organizations:ListAccounts",
                  ],
                  "Effect": "Allow",
                  "Resource": [
                    "*",
                  ],
                  "Sid": "OrganisationsListDetective",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomDetectiveUpdateGraphCustomResourceProviderHandlerD4473EC1": {
      "DependsOn": [
        "CustomDetectiveUpdateGraphCustomResourceProviderRole54CD7295",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomDetectiveUpdateGraphCustomResourceProviderRole54CD7295",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomDetectiveUpdateGraphCustomResourceProviderLogGroupDF150426": {
      "DeletionPolicy": "Retain",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomDetectiveUpdateGraphCustomResourceProviderHandlerD4473EC1",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Retain",
    },
    "CustomDetectiveUpdateGraphCustomResourceProviderRole54CD7295": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "organizations:DeregisterDelegatedAdministrator",
                    "organizations:DescribeOrganization",
                    "organizations:EnableAWSServiceAccess",
                    "organizations:ListAWSServiceAccessForOrganization",
                    "organizations:ListAccounts",
                    "organizations:ListDelegatedAdministrators",
                    "organizations:RegisterDelegatedAdministrator",
                    "organizations:ServicePrincipal",
                    "organizations:UpdateOrganizationConfiguration",
                  ],
                  "Condition": {
                    "StringLikeIfExists": {
                      "organizations:DeregisterDelegatedAdministrator": [
                        "detective.amazonaws.com",
                      ],
                      "organizations:DescribeOrganization": [
                        "detective.amazonaws.com",
                      ],
                      "organizations:EnableAWSServiceAccess": [
                        "detective.amazonaws.com",
                      ],
                      "organizations:ListAWSServiceAccessForOrganization": [
                        "detective.amazonaws.com",
                      ],
                      "organizations:ListAccounts": [
                        "detective.amazonaws.com",
                      ],
                      "organizations:ListDelegatedAdministrators": [
                        "detective.amazonaws.com",
                      ],
                      "organizations:RegisterDelegatedAdministrator": [
                        "detective.amazonaws.com",
                      ],
                      "organizations:ServicePrincipal": [
                        "detective.amazonaws.com",
                      ],
                      "organizations:UpdateOrganizationConfiguration": [
                        "detective.amazonaws.com",
                      ],
                    },
                  },
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "DetectiveConfigureOrganizationAdminAccountTaskOrganizationActions",
                },
                {
                  "Action": [
                    "detective:UpdateOrganizationConfiguration",
                    "detective:ListGraphs",
                    "detective:ListMembers",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "DetectiveUpdateGraphTaskDetectiveActions",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomGuardDutyCreateMembersCustomResourceProviderHandler0A16C673": {
      "DependsOn": [
        "CustomGuardDutyCreateMembersCustomResourceProviderRole2D82020E",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomGuardDutyCreateMembersCustomResourceProviderRole2D82020E",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomGuardDutyCreateMembersCustomResourceProviderLogGroupB5134860": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomGuardDutyCreateMembersCustomResourceProviderHandler0A16C673",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomGuardDutyCreateMembersCustomResourceProviderRole2D82020E": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "organizations:ListAccounts",
                  ],
                  "Condition": {
                    "StringLikeIfExists": {
                      "organizations:ListAccounts": [
                        "guardduty.amazonaws.com",
                      ],
                    },
                  },
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "GuardDutyCreateMembersTaskOrganizationAction",
                },
                {
                  "Action": [
                    "guardDuty:ListDetectors",
                    "guardDuty:ListOrganizationAdminAccounts",
                    "guardDuty:UpdateOrganizationConfiguration",
                    "guardduty:CreateMembers",
                    "guardduty:DeleteMembers",
                    "guardduty:DisassociateMembers",
                    "guardduty:ListDetectors",
                    "guardduty:ListMembers",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "GuardDutyCreateMembersTaskGuardDutyActions",
                },
                {
                  "Action": [
                    "iam:CreateServiceLinkedRole",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "ServiceLinkedRoleSecurityHub",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomGuardDutyUpdateDetectorCustomResourceProviderHandler78DF0FF9": {
      "DependsOn": [
        "CustomGuardDutyUpdateDetectorCustomResourceProviderRole3014073E",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomGuardDutyUpdateDetectorCustomResourceProviderRole3014073E",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomGuardDutyUpdateDetectorCustomResourceProviderLogGroup0E4B1900": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomGuardDutyUpdateDetectorCustomResourceProviderHandler78DF0FF9",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomGuardDutyUpdateDetectorCustomResourceProviderRole3014073E": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "guardduty:ListDetectors",
                    "guardduty:ListMembers",
                    "guardduty:UpdateDetector",
                    "guardduty:UpdateMemberDetectors",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "GuardDutyUpdateDetectorTaskGuardDutyActions",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomMacieCreateMemberCustomResourceProviderHandler913F75DB": {
      "DependsOn": [
        "CustomMacieCreateMemberCustomResourceProviderRole3E8977EE",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomMacieCreateMemberCustomResourceProviderRole3E8977EE",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomMacieCreateMemberCustomResourceProviderLogGroupB2DBC335": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomMacieCreateMemberCustomResourceProviderHandler913F75DB",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomMacieCreateMemberCustomResourceProviderRole3E8977EE": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "organizations:ListAccounts",
                  ],
                  "Condition": {
                    "StringLikeIfExists": {
                      "organizations:ListAccounts": [
                        "macie.amazonaws.com",
                      ],
                    },
                  },
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "MacieCreateMemberTaskOrganizationAction",
                },
                {
                  "Action": [
                    "macie2:CreateMember",
                    "macie2:DeleteMember",
                    "macie2:DescribeOrganizationConfiguration",
                    "macie2:DisassociateMember",
                    "macie2:EnableMacie",
                    "macie2:GetMacieSession",
                    "macie2:ListMembers",
                    "macie2:UpdateOrganizationConfiguration",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "MacieCreateMemberTaskMacieActions",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomS3PutBucketReplicationCustomResourceProviderHandler1D75398C": {
      "DependsOn": [
        "CustomS3PutBucketReplicationCustomResourceProviderRole1C378488",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomS3PutBucketReplicationCustomResourceProviderRole1C378488",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomS3PutBucketReplicationCustomResourceProviderLogGroup6A67905E": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomS3PutBucketReplicationCustomResourceProviderHandler1D75398C",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomS3PutBucketReplicationCustomResourceProviderRole1C378488": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "iam:PassRole",
                    "s3:PutLifecycleConfiguration",
                    "s3:PutReplicationConfiguration",
                    "s3:PutBucketVersioning",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "S3PutReplicationConfigurationTaskActions",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomSSMShareDocumentCustomResourceProviderHandler02D98C87": {
      "DependsOn": [
        "CustomSSMShareDocumentCustomResourceProviderRole53A2A3EC",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomSSMShareDocumentCustomResourceProviderRole53A2A3EC",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomSSMShareDocumentCustomResourceProviderLogGroup11AEA42B": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomSSMShareDocumentCustomResourceProviderHandler02D98C87",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomSSMShareDocumentCustomResourceProviderRole53A2A3EC": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "ssm:DescribeDocumentPermission",
                    "ssm:ModifyDocumentPermission",
                  ],
                  "Effect": "Allow",
                  "Resource": {
                    "Fn::Join": [
                      "",
                      [
                        "arn:",
                        {
                          "Ref": "AWS::Partition",
                        },
                        ":ssm:us-east-1:222222222222:document/*",
                      ],
                    ],
                  },
                  "Sid": "ShareDocumentActions",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomSecurityHubCreateMembersCustomResourceProviderHandler31D82BF3": {
      "DependsOn": [
        "CustomSecurityHubCreateMembersCustomResourceProviderRoleFD355CB6",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomSecurityHubCreateMembersCustomResourceProviderRoleFD355CB6",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomSecurityHubCreateMembersCustomResourceProviderLogGroup51212673": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomSecurityHubCreateMembersCustomResourceProviderHandler31D82BF3",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomSecurityHubCreateMembersCustomResourceProviderRoleFD355CB6": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "organizations:ListAccounts",
                  ],
                  "Condition": {
                    "StringLikeIfExists": {
                      "organizations:ListAccounts": [
                        "securityhub.amazonaws.com",
                      ],
                    },
                  },
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "SecurityHubCreateMembersTaskOrganizationAction",
                },
                {
                  "Action": [
                    "securityhub:CreateMembers",
                    "securityhub:DeleteMembers",
                    "securityhub:DisassociateMembers",
                    "securityhub:EnableSecurityHub",
                    "securityhub:ListMembers",
                    "securityhub:UpdateOrganizationConfiguration",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "SecurityHubCreateMembersTaskSecurityHubActions",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomSecurityHubRegionAggregationCustomResourceProviderHandler4B24978A": {
      "DependsOn": [
        "CustomSecurityHubRegionAggregationCustomResourceProviderRole15741044",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomSecurityHubRegionAggregationCustomResourceProviderRole15741044",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 180,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomSecurityHubRegionAggregationCustomResourceProviderLogGroup241F2158": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "KmsKeyId": {
          "Ref": "SsmParameterValueacceleratorkmscloudwatchkeyarnC96584B6F00A464EAD1953AFF4B05118Parameter",
        },
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomSecurityHubRegionAggregationCustomResourceProviderHandler4B24978A",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomSecurityHubRegionAggregationCustomResourceProviderRole15741044": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "securityhub:CreateFindingAggregator",
                    "securityhub:UpdateFindingAggregator",
                    "securityhub:DeleteFindingAggregator",
                    "securityhub:ListFindingAggregators",
                    "securityhub:GetFindingAggregator",
                    "securityhub:DescribeHub",
                  ],
                  "Effect": "Allow",
                  "Resource": "*",
                  "Sid": "SecurityHubModifyRegionAggregation",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "CustomSsmGetParameterValueCustomResourceProviderHandlerAAD0E7EE": {
      "DependsOn": [
        "CustomSsmGetParameterValueCustomResourceProviderRoleB3AFDDB2",
      ],
      "Properties": {
        "Code": {
          "S3Bucket": "cdk-hnb659fds-assets-222222222222-us-east-1",
          "S3Key": "REPLACED-GENERATED-NAME.zip",
        },
        "Handler": "__entrypoint__.handler",
        "MemorySize": 128,
        "Role": {
          "Fn::GetAtt": [
            "CustomSsmGetParameterValueCustomResourceProviderRoleB3AFDDB2",
            "Arn",
          ],
        },
        "Runtime": "nodejs16.x",
        "Timeout": 900,
      },
      "Type": "AWS::Lambda::Function",
    },
    "CustomSsmGetParameterValueCustomResourceProviderLogGroup780D220D": {
      "DeletionPolicy": "Delete",
      "Properties": {
        "LogGroupName": {
          "Fn::Join": [
            "",
            [
              "/aws/lambda/",
              {
                "Ref": "CustomSsmGetParameterValueCustomResourceProviderHandlerAAD0E7EE",
              },
            ],
          ],
        },
        "RetentionInDays": 3653,
      },
      "Type": "AWS::Logs::LogGroup",
      "UpdateReplacePolicy": "Delete",
    },
    "CustomSsmGetParameterValueCustomResourceProviderRoleB3AFDDB2": {
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com",
              },
            },
          ],
          "Version": "2012-10-17",
        },
        "ManagedPolicyArns": [
          {
            "Fn::Sub": "arn:\${AWS::Partition}:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
          },
        ],
        "Policies": [
          {
            "PolicyDocument": {
              "Statement": [
                {
                  "Action": [
                    "ssm:GetParameters",
                    "ssm:GetParameter",
                    "ssm:DescribeParameters",
                  ],
                  "Effect": "Allow",
                  "Resource": [
                    "*",
                  ],
                  "Sid": "SsmGetParameterActions",
                },
                {
                  "Action": [
                    "sts:AssumeRole",
                  ],
                  "Effect": "Allow",
                  "Resource": [
                    {
                      "Fn::Join": [
                        "",
                        [
                          "arn:",
                          {
                            "Ref": "AWS::Partition",
                          },
                          ":iam::*:role/AWSAccelerator*",
                        ],
                      ],
                    },
                  ],
                  "Sid": "StsAssumeRoleActions",
                },
              ],
              "Version": "2012-10-17",
            },
            "PolicyName": "Inline",
          },
        ],
      },
      "Type": "AWS::IAM::Role",
    },
    "DetectiveGraphConfig248C4B9F": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomDetectiveUpdateGraphCustomResourceProviderLogGroupDF150426",
        "DetectiveMembers42A16137",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomDetectiveUpdateGraphCustomResourceProviderHandlerD4473EC1",
            "Arn",
          ],
        },
        "region": "us-east-1",
      },
      "Type": "Custom::DetectiveUpdateGraph",
      "UpdateReplacePolicy": "Delete",
    },
    "DetectiveMembers42A16137": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomDetectiveCreateMembersCustomResourceProviderLogGroup8A5563BD",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomDetectiveCreateMembersCustomResourceProviderHandler0A0D060D",
            "Arn",
          ],
        },
        "partition": {
          "Ref": "AWS::Partition",
        },
        "region": "us-east-1",
      },
      "Type": "Custom::DetectiveCreateMembers",
      "UpdateReplacePolicy": "Delete",
    },
    "GuardDutyDetectorConfigDD64B103": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomGuardDutyUpdateDetectorCustomResourceProviderLogGroup0E4B1900",
        "GuardDutyMembersD34CA003",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomGuardDutyUpdateDetectorCustomResourceProviderHandler78DF0FF9",
            "Arn",
          ],
        },
        "enableEksProtection": false,
        "enableS3Protection": true,
        "exportFrequency": "FIFTEEN_MINUTES",
        "region": "us-east-1",
      },
      "Type": "Custom::GuardDutyUpdateDetector",
      "UpdateReplacePolicy": "Delete",
    },
    "GuardDutyMembersD34CA003": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomGuardDutyCreateMembersCustomResourceProviderLogGroupB5134860",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomGuardDutyCreateMembersCustomResourceProviderHandler0A16C673",
            "Arn",
          ],
        },
        "enableEksProtection": false,
        "enableS3Protection": true,
        "partition": {
          "Ref": "AWS::Partition",
        },
        "region": "us-east-1",
      },
      "Type": "Custom::GuardDutyCreateMembers",
      "UpdateReplacePolicy": "Delete",
    },
    "MacieMembers1B6840B4": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomMacieCreateMemberCustomResourceProviderLogGroupB2DBC335",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomMacieCreateMemberCustomResourceProviderHandler913F75DB",
            "Arn",
          ],
        },
        "adminAccountId": "222222222222",
        "partition": {
          "Ref": "AWS::Partition",
        },
        "region": "us-east-1",
      },
      "Type": "Custom::MacieCreateMember",
      "UpdateReplacePolicy": "Delete",
    },
    "PutS3Encryption383DF0CE": {
      "Properties": {
        "Content": {
          "assumeRole": "{{ AutomationAssumeRole }}",
          "description": "Enables Encryption on S3 Bucket",
          "mainSteps": [
            {
              "action": "aws:executeAwsApi",
              "inputs": {
                "Api": "PutBucketEncryption",
                "Bucket": "{{BucketName}}",
                "ServerSideEncryptionConfiguration": {
                  "Rules": [
                    {
                      "ApplyServerSideEncryptionByDefault": {
                        "KMSMasterKeyID": "{{KMSMasterKey}}",
                        "SSEAlgorithm": "aws:kms",
                      },
                    },
                  ],
                },
                "Service": "s3",
              },
              "isEnd": true,
              "name": "PutBucketEncryption",
            },
          ],
          "parameters": {
            "AutomationAssumeRole": {
              "default": "",
              "description": "(Optional) The ARN of the role that allows Automation to perform the actions on your behalf.",
              "type": "String",
            },
            "BucketName": {
              "description": "(Required) The name of the S3 Bucket whose content will be encrypted.",
              "type": "String",
            },
            "KMSMasterKey": {
              "description": "(Optional) AWS Key Management Service (KMS) customer master key ARN to use for the default encryption.",
              "type": "String",
            },
          },
          "schemaVersion": "0.3",
        },
        "DocumentType": "Automation",
        "Name": "Put-S3-Encryption",
        "UpdateMethod": "NewVersion",
      },
      "Type": "AWS::SSM::Document",
    },
    "PutS3EncryptionShareDocumentF7F3A94E": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomSSMShareDocumentCustomResourceProviderLogGroup11AEA42B",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomSSMShareDocumentCustomResourceProviderHandler02D98C87",
            "Arn",
          ],
        },
        "accountIds": [
          "111111111111",
          "333333333333",
          "222222222222",
          "444444444444",
          "555555555555",
          "666666666666",
        ],
        "name": {
          "Ref": "PutS3Encryption383DF0CE",
        },
      },
      "Type": "Custom::SSMShareDocument",
      "UpdateReplacePolicy": "Delete",
    },
    "SecurityHubMembers2A2B77C4": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomSecurityHubCreateMembersCustomResourceProviderLogGroup51212673",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomSecurityHubCreateMembersCustomResourceProviderHandler31D82BF3",
            "Arn",
          ],
        },
        "partition": {
          "Ref": "AWS::Partition",
        },
        "region": "us-east-1",
      },
      "Type": "Custom::SecurityHubCreateMembers",
      "UpdateReplacePolicy": "Delete",
    },
    "SecurityHubRegionAggregation0CC69E1B": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomSecurityHubRegionAggregationCustomResourceProviderLogGroup241F2158",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomSecurityHubRegionAggregationCustomResourceProviderHandler4B24978A",
            "Arn",
          ],
        },
        "partition": {
          "Ref": "AWS::Partition",
        },
        "region": "us-east-1",
      },
      "Type": "Custom::SecurityHubRegionAggregation",
      "UpdateReplacePolicy": "Delete",
    },
    "SsmElbEnableLoggingDB91F105": {
      "Properties": {
        "Content": {
          "assumeRole": "{{ AutomationAssumeRole }}",
          "description": "Enable logging on Elastic Load-Balancer",
          "mainSteps": [
            {
              "action": "aws:executeAwsApi",
              "inputs": {
                "Api": "get_caller_identity",
                "Service": "sts",
              },
              "name": "getAccount",
              "outputs": [
                {
                  "Name": "Id",
                  "Selector": "$.Account",
                  "Type": "String",
                },
              ],
            },
            {
              "action": "aws:executeAwsApi",
              "inputs": {
                "Api": "describe_load_balancers",
                "LoadBalancerArns": [
                  "{{ LoadBalancerArn }}",
                ],
                "Service": "elbv2",
              },
              "name": "getLoadBalancer",
              "outputs": [
                {
                  "Name": "Name",
                  "Selector": "$.LoadBalancers[0].LoadBalancerName",
                  "Type": "String",
                },
              ],
            },
            {
              "action": "aws:executeAwsApi",
              "inputs": {
                "Api": "modify_load_balancer_attributes",
                "Attributes": [
                  {
                    "Key": "access_logs.s3.enabled",
                    "Value": "true",
                  },
                  {
                    "Key": "access_logs.s3.bucket",
                    "Value": "{{ LogDestination }}",
                  },
                  {
                    "Key": "access_logs.s3.prefix",
                    "Value": "elb/elb-{{ getLoadBalancer.Name }}/{{ getAccount.Id }}",
                  },
                ],
                "LoadBalancerArn": "{{ LoadBalancerArn }}",
                "Service": "elbv2",
              },
              "name": "enableLogging",
            },
          ],
          "parameters": {
            "AutomationAssumeRole": {
              "type": "String",
            },
            "LoadBalancerArn": {
              "type": "String",
            },
            "LogDestination": {
              "type": "String",
            },
          },
          "schemaVersion": "0.3",
        },
        "DocumentType": "Automation",
        "Name": "SSM-ELB-Enable-Logging",
        "UpdateMethod": "NewVersion",
      },
      "Type": "AWS::SSM::Document",
    },
    "SsmElbEnableLoggingShareDocument16727B30": {
      "DeletionPolicy": "Delete",
      "DependsOn": [
        "CustomSSMShareDocumentCustomResourceProviderLogGroup11AEA42B",
      ],
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomSSMShareDocumentCustomResourceProviderHandler02D98C87",
            "Arn",
          ],
        },
        "accountIds": [
          "111111111111",
          "333333333333",
          "222222222222",
          "444444444444",
          "555555555555",
          "666666666666",
        ],
        "name": {
          "Ref": "SsmElbEnableLoggingDB91F105",
        },
      },
      "Type": "Custom::SSMShareDocument",
      "UpdateReplacePolicy": "Delete",
    },
    "SsmParamAcceleratorVersionFF83282D": {
      "Properties": {
        "Name": "/accelerator/AWSAccelerator-SecurityAuditStack-222222222222-us-east-1/version",
        "Type": "String",
        "Value": "1.4.3",
      },
      "Type": "AWS::SSM::Parameter",
    },
    "SsmParamOrganizationAuditManagerPublishingDestinationBucketArn488415E7": {
      "Properties": {
        "Name": "/accelerator/organization/security/auditManager/publishing-destination/bucket-arn",
        "Type": "String",
        "Value": {
          "Fn::GetAtt": [
            "AuditManagerPublishingDestinationBucket74974FCF",
            "Arn",
          ],
        },
      },
      "Type": "AWS::SSM::Parameter",
    },
    "SsmParamStackId521A78D3": {
      "Properties": {
        "Name": "/accelerator/AWSAccelerator-SecurityAuditStack-222222222222-us-east-1/stack-id",
        "Type": "String",
        "Value": {
          "Ref": "AWS::StackId",
        },
      },
      "Type": "AWS::SSM::Parameter",
    },
  },
}
`;
